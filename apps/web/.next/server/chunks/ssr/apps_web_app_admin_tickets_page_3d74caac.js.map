{"version":3,"sources":["../../../../../../apps/web/app/admin/tickets/page.js"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\n\nexport default function Tickets() {\n  const [questions, setQuestions] = useState([])\n  const [faqs, setFaqs] = useState([])\n  const [filterType, setFilterType] = useState('')\n  const [filterStatus, setFilterStatus] = useState('')\n  const [showAnswerModal, setShowAnswerModal] = useState(false)\n  const [selectedQuestion, setSelectedQuestion] = useState(null)\n  const [answer, setAnswer] = useState('')\n\n  useEffect(() => {\n    loadQuestions()\n    loadFaqs()\n  }, [])\n\n  const loadQuestions = () => {\n    const storedQuestions = localStorage.getItem('bookQuestions')\n    if (storedQuestions) {\n      setQuestions(JSON.parse(storedQuestions))\n    }\n  }\n\n  const loadFaqs = () => {\n    const storedFaqs = localStorage.getItem('faq')\n    if (storedFaqs) {\n      setFaqs(JSON.parse(storedFaqs))\n    }\n  }\n\n  const updateQuestionStatus = (id, newStatus) => {\n    const updatedQuestions = questions.map(q =>\n      q.id === id ? { ...q, status: newStatus } : q\n    )\n    setQuestions(updatedQuestions)\n    localStorage.setItem('bookQuestions', JSON.stringify(updatedQuestions))\n  }\n\n  const openAnswerModal = (question) => {\n    setSelectedQuestion(question)\n    setAnswer('')\n    setShowAnswerModal(true)\n  }\n\n  const submitAnswer = () => {\n    if (!selectedQuestion || !answer.trim()) return\n\n    // Agregar a FAQs\n    const newFaq = {\n      id: Date.now(),\n      question: selectedQuestion.question,\n      answer: answer.trim(),\n      createdAt: new Date().toISOString()\n    }\n    const updatedFaqs = [...faqs, newFaq]\n    setFaqs(updatedFaqs)\n    localStorage.setItem('faq', JSON.stringify(updatedFaqs))\n\n    // Actualizar estado de la pregunta\n    updateQuestionStatus(selectedQuestion.id, 'respondido')\n\n    // Cerrar modal\n    setShowAnswerModal(false)\n    setSelectedQuestion(null)\n    setAnswer('')\n  }\n\n  const updateFaqAnswer = (id, newAnswer) => {\n    const updatedFaqs = faqs.map(faq =>\n      faq.id === id ? { ...faq, answer: newAnswer } : faq\n    )\n    setFaqs(updatedFaqs)\n    localStorage.setItem('faq', JSON.stringify(updatedFaqs))\n  }\n\n  const deleteFaq = (id) => {\n    const updatedFaqs = faqs.filter(faq => faq.id !== id)\n    setFaqs(updatedFaqs)\n    localStorage.setItem('faq', JSON.stringify(updatedFaqs))\n  }\n\n  const filteredQuestions = questions.filter(q => {\n    const matchesType = !filterType || q.type === filterType\n    const matchesStatus = !filterStatus || q.status === filterStatus\n    return matchesType && matchesStatus\n  })\n\n  const getStatusColor = (status) => {\n    switch (status) {\n      case 'abierto': return 'bg-red-100 text-red-800'\n      case 'respondido': return 'bg-yellow-100 text-yellow-800'\n      case 'cerrado': return 'bg-gray-100 text-gray-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-8\">\n      <h1 className=\"text-3xl font-bold mb-6\">Gestión de Preguntas del Libro</h1>\n\n      {/* Sección de Preguntas */}\n      <div className=\"mb-12\">\n        <h2 className=\"text-2xl font-semibold mb-4\">Preguntas Recibidas</h2>\n\n        {/* Filtros */}\n        <div className=\"mb-6 flex space-x-4\">\n          <select\n            value={filterType}\n            onChange={(e) => setFilterType(e.target.value)}\n            className=\"border border-gray-300 rounded px-4 py-2\"\n          >\n            <option value=\"\">Todos los tipos</option>\n            <option value=\"pregunta\">Pregunta sobre el libro</option>\n            <option value=\"duda\">Duda general</option>\n            <option value=\"soporte\">Soporte técnico</option>\n          </select>\n          <select\n            value={filterStatus}\n            onChange={(e) => setFilterStatus(e.target.value)}\n            className=\"border border-gray-300 rounded px-4 py-2\"\n          >\n            <option value=\"\">Todos los estados</option>\n            <option value=\"abierto\">Abierto</option>\n            <option value=\"respondido\">Respondido</option>\n            <option value=\"cerrado\">Cerrado</option>\n          </select>\n        </div>\n\n        {/* Lista de preguntas */}\n        <div className=\"space-y-4\">\n          {filteredQuestions.length === 0 ? (\n            <p className=\"text-gray-500 text-center py-8\">No hay preguntas que coincidan con los filtros.</p>\n          ) : (\n            filteredQuestions.map((q) => (\n              <div key={q.id} className=\"bg-white p-6 rounded-lg shadow\">\n                <div className=\"flex justify-between items-start mb-4\">\n                  <div>\n                    <h3 className=\"text-lg font-semibold\">{q.name} - {q.question}</h3>\n                    <p className=\"text-gray-600\">Email: {q.email}</p>\n                    <p className=\"text-sm text-gray-500\">{new Date(q.createdAt).toLocaleString()}</p>\n                  </div>\n                  <span className={`px-2 py-1 rounded text-sm ${getStatusColor(q.status)}`}>\n                    {q.status === 'abierto' ? 'Abierto' : q.status === 'respondido' ? 'Respondido' : 'Cerrado'}\n                  </span>\n                </div>\n                <div className=\"flex space-x-2\">\n                  <button\n                    onClick={() => openAnswerModal(q)}\n                    className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\"\n                  >\n                    Responder y Agregar a FAQ\n                  </button>\n                  <button\n                    onClick={() => updateQuestionStatus(q.id, 'respondido')}\n                    className=\"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600\"\n                  >\n                    Marcar como Respondido\n                  </button>\n                  <button\n                    onClick={() => updateQuestionStatus(q.id, 'cerrado')}\n                    className=\"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600\"\n                  >\n                    Cerrar\n                  </button>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* Sección de FAQs */}\n      <div>\n        <h2 className=\"text-2xl font-semibold mb-4\">Preguntas Frecuentes (FAQ)</h2>\n        <div className=\"space-y-4\">\n          {faqs.length === 0 ? (\n            <p className=\"text-gray-500 text-center py-8\">No hay preguntas frecuentes aún.</p>\n          ) : (\n            faqs.map((faq) => (\n              <div key={faq.id} className=\"bg-white p-6 rounded-lg shadow\">\n                <div className=\"mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-2\">{faq.question}</h3>\n                  <textarea\n                    value={faq.answer}\n                    onChange={(e) => updateFaqAnswer(faq.id, e.target.value)}\n                    className=\"w-full p-2 border border-gray-300 rounded\"\n                    rows=\"3\"\n                    placeholder=\"Escribe la respuesta...\"\n                  />\n                  <p className=\"text-sm text-gray-500 mt-1\">\n                    Creado: {new Date(faq.createdAt).toLocaleDateString()}\n                  </p>\n                </div>\n                <div className=\"flex justify-end\">\n                  <button\n                    onClick={() => deleteFaq(faq.id)}\n                    className=\"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600\"\n                  >\n                    Eliminar FAQ\n                  </button>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* Modal para responder pregunta */}\n      {showAnswerModal && selectedQuestion && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white p-8 rounded-lg shadow-lg max-w-2xl w-full mx-4\">\n            <h3 className=\"text-2xl font-bold mb-4\">Responder Pregunta</h3>\n            <div className=\"mb-4\">\n              <h4 className=\"font-semibold mb-2\">Pregunta de {selectedQuestion.name}:</h4>\n              <p className=\"bg-gray-100 p-3 rounded\">{selectedQuestion.question}</p>\n            </div>\n            <div className=\"mb-4\">\n              <label className=\"block text-sm font-medium mb-2\">Tu Respuesta:</label>\n              <textarea\n                value={answer}\n                onChange={(e) => setAnswer(e.target.value)}\n                className=\"w-full p-3 border border-gray-300 rounded\"\n                rows=\"6\"\n                placeholder=\"Escribe una respuesta detallada...\"\n              />\n            </div>\n            <div className=\"flex justify-end space-x-2\">\n              <button\n                onClick={() => setShowAnswerModal(false)}\n                className=\"px-4 py-2 bg-gray-300 rounded hover:bg-gray-400\"\n              >\n                Cancelar\n              </button>\n              <button\n                onClick={submitAnswer}\n                disabled={!answer.trim()}\n                className=\"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-400\"\n              >\n                Agregar a FAQ y Responder\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}"],"names":[],"mappings":"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"}