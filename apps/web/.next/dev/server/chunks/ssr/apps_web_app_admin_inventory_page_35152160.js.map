{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/WADEOW/PROYECTOS/LibroWeb/codigoLibroWeb/apps/web/app/admin/inventory/page.js"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\n\nexport default function InventoryAdmin() {\n  const [stock, setStock] = useState({})\n  const [editingId, setEditingId] = useState(null)\n  const [newQuantity, setNewQuantity] = useState('')\n  const [loading, setLoading] = useState(true)\n  const [orders, setOrders] = useState([])\n\n  const loadStock = async () => {\n    try {\n      const res = await fetch('/api/stock')\n      if (!res.ok) {\n        console.error('Error en la respuesta de la API de stock')\n        setStock({})\n        setLoading(false)\n        return\n      }\n      const data = await res.json()\n      setStock(data)\n      setLoading(false)\n    } catch (error) {\n      console.error('Error cargando stock:', error)\n      setStock({})\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => {\n    loadStock()\n    loadOrders()\n  }, [])\n\n  const loadOrders = () => {\n    const storedOrders = localStorage.getItem('orders')\n    if (storedOrders) {\n      setOrders(JSON.parse(storedOrders))\n    }\n  }\n\n  const updateStock = async (id, quantity) => {\n    await fetch('/api/stock', {\n      method: 'PUT',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ id, quantity: parseInt(quantity) }),\n    })\n    loadStock()\n    setEditingId(null)\n    setNewQuantity('')\n  }\n\n  const getSalesStats = () => {\n    const totalPhysicalSold = orders.reduce((sum, order) => sum + (order.physical || 0), 0)\n    const totalDigitalSold = orders.reduce((sum, order) => sum + (order.digital || 0), 0)\n    const totalRevenue = orders.reduce((sum, order) => sum + (order.total || 0), 0)\n    const totalOrders = orders.length\n\n    return {\n      totalPhysicalSold,\n      totalDigitalSold,\n      totalRevenue,\n      totalOrders\n    }\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-8\">\n      <h1 className=\"text-3xl font-bold mb-6\">Gestión de Inventario</h1>\n\n      <div>\n        <h2 className=\"text-2xl font-semibold mb-4\">Control de Unidades Restantes</h2>\n        <div className=\"space-y-4\">\n          {loading ? (\n            <p className=\"text-gray-500 text-center py-8\">Cargando inventario...</p>\n          ) : Object.keys(stock).length === 0 ? (\n            <p className=\"text-gray-500 text-center py-8\">No hay inventario disponible o error al cargar.</p>\n          ) : (\n            Object.entries(stock).map(([id, item]) => {\n              return (\n                <div key={id} className=\"bg-white p-6 rounded-lg shadow\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold\">{item.title}</h3>\n                      <p className=\"text-gray-600\">ID: {id}</p>\n                    </div>\n                    <div className=\"text-right\">\n                      {editingId === id ? (\n                        <div className=\"flex items-center space-x-2\">\n                          <button\n                            onClick={() => setNewQuantity(Math.max(0, parseInt(newQuantity) - 1).toString())}\n                            className=\"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600\"\n                          >\n                            -\n                          </button>\n                          <input\n                            type=\"number\"\n                            value={newQuantity}\n                            onChange={(e) => setNewQuantity(e.target.value)}\n                            className=\"border border-gray-300 rounded px-2 py-1 w-20 text-center\"\n                            min=\"0\"\n                          />\n                          <button\n                            onClick={() => setNewQuantity((parseInt(newQuantity) + 1).toString())}\n                            className=\"bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600\"\n                          >\n                            +\n                          </button>\n                          <button\n                            onClick={() => updateStock(id, newQuantity)}\n                            className=\"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600\"\n                          >\n                            Guardar\n                          </button>\n                          <button\n                            onClick={() => setEditingId(null)}\n                            className=\"bg-gray-500 text-white px-3 py-1 rounded hover:bg-gray-600\"\n                          >\n                            Cancelar\n                          </button>\n                        </div>\n                      ) : (\n                        <div className=\"flex items-center space-x-2\">\n                          <button\n                            onClick={() => updateStock(id, item.quantity - 1)}\n                            className=\"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600\"\n                            disabled={item.quantity <= 0}\n                          >\n                            -1\n                          </button>\n                          <span className=\"text-xl font-bold\">Cantidad: {item.quantity}</span>\n                          <button\n                            onClick={() => updateStock(id, item.quantity + 1)}\n                            className=\"bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600\"\n                          >\n                            +1\n                          </button>\n                          <button\n                            onClick={() => {\n                              setEditingId(id)\n                              setNewQuantity(item.quantity.toString())\n                            }}\n                            className=\"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600\"\n                          >\n                            Editar\n                          </button>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              )\n            })\n          )}\n        </div>\n      </div>\n\n      {/* Estadísticas de Ventas */}\n      <div className=\"mt-12\">\n        <h2 className=\"text-2xl font-semibold mb-4\">Estadísticas de Ventas</h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6\">\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"text-lg font-semibold text-gray-700\">Total de Órdenes</h3>\n            <p className=\"text-3xl font-bold text-blue-600\">{getSalesStats().totalOrders}</p>\n          </div>\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"text-lg font-semibold text-gray-700\">Libros Físicos Vendidos</h3>\n            <p className=\"text-3xl font-bold text-green-600\">{getSalesStats().totalPhysicalSold}</p>\n          </div>\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"text-lg font-semibold text-gray-700\">Libros Digitales Vendidos</h3>\n            <p className=\"text-3xl font-bold text-purple-600\">{getSalesStats().totalDigitalSold}</p>\n          </div>\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h3 className=\"text-lg font-semibold text-gray-700\">Ingresos Totales</h3>\n            <p className=\"text-3xl font-bold text-yellow-600\">${getSalesStats().totalRevenue.toFixed(2)}</p>\n          </div>\n        </div>\n\n        <h3 className=\"text-xl font-semibold mb-4\">Historial de Ventas Recientes</h3>\n        <div className=\"space-y-4\">\n          {orders.length === 0 ? (\n            <p className=\"text-gray-500 text-center py-8\">No hay ventas registradas aún.</p>\n          ) : (\n            orders.slice(0, 10).map((order) => (\n              <div key={order.id} className=\"bg-white p-6 rounded-lg shadow\">\n                <div className=\"flex justify-between items-start mb-4\">\n                  <div>\n                    <h4 className=\"text-lg font-semibold\">Orden #{order.id}</h4>\n                    <p className=\"text-gray-600\">Cliente: {order.shipping?.name} ({order.shipping?.email})</p>\n                    <p className=\"text-sm text-gray-500\">Fecha: {new Date(order.createdAt).toLocaleString()}</p>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-lg font-bold\">Total: ${order.total?.toFixed(2)}</p>\n                    <p className=\"text-sm text-gray-500\">Estado: {order.status}</p>\n                  </div>\n                </div>\n                <div className=\"mb-4\">\n                  <h5 className=\"font-semibold mb-2\">Productos:</h5>\n                  <ul className=\"list-disc list-inside text-sm\">\n                    <li>Libro Físico: {order.physical} unidades</li>\n                    <li>Libro Digital: {order.digital} unidades</li>\n                  </ul>\n                </div>\n                <div>\n                  <h5 className=\"font-semibold mb-2\">Dirección de Envío:</h5>\n                  <p className=\"text-sm text-gray-600\">\n                    {order.shipping?.address}, {order.shipping?.city}, {order.shipping?.postalCode}, {order.shipping?.country}\n                  </p>\n                </div>\n              </div>\n            ))\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC,CAAC;IACpC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC,EAAE;IAEvC,MAAM,YAAY;QAChB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM;YACxB,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,QAAQ,KAAK,CAAC;gBACd,SAAS,CAAC;gBACV,WAAW;gBACX;YACF;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,SAAS;YACT,WAAW;QACb,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,yBAAyB;YACvC,SAAS,CAAC;YACV,WAAW;QACb;IACF;IAEA,IAAA,kNAAS,EAAC;QACR;QACA;IACF,GAAG,EAAE;IAEL,MAAM,aAAa;QACjB,MAAM,eAAe,aAAa,OAAO,CAAC;QAC1C,IAAI,cAAc;YAChB,UAAU,KAAK,KAAK,CAAC;QACvB;IACF;IAEA,MAAM,cAAc,OAAO,IAAI;QAC7B,MAAM,MAAM,cAAc;YACxB,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAI,UAAU,SAAS;YAAU;QAC1D;QACA;QACA,aAAa;QACb,eAAe;IACjB;IAEA,MAAM,gBAAgB;QACpB,MAAM,oBAAoB,OAAO,MAAM,CAAC,CAAC,KAAK,QAAU,MAAM,CAAC,MAAM,QAAQ,IAAI,CAAC,GAAG;QACrF,MAAM,mBAAmB,OAAO,MAAM,CAAC,CAAC,KAAK,QAAU,MAAM,CAAC,MAAM,OAAO,IAAI,CAAC,GAAG;QACnF,MAAM,eAAe,OAAO,MAAM,CAAC,CAAC,KAAK,QAAU,MAAM,CAAC,MAAM,KAAK,IAAI,CAAC,GAAG;QAC7E,MAAM,cAAc,OAAO,MAAM;QAEjC,OAAO;YACL;YACA;YACA;YACA;QACF;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAA0B;;;;;;0BAExC,8OAAC;;kCACC,8OAAC;wBAAG,WAAU;kCAA8B;;;;;;kCAC5C,8OAAC;wBAAI,WAAU;kCACZ,wBACC,8OAAC;4BAAE,WAAU;sCAAiC;;;;;mCAC5C,OAAO,IAAI,CAAC,OAAO,MAAM,KAAK,kBAChC,8OAAC;4BAAE,WAAU;sCAAiC;;;;;mCAE9C,OAAO,OAAO,CAAC,OAAO,GAAG,CAAC,CAAC,CAAC,IAAI,KAAK;4BACnC,qBACE,8OAAC;gCAAa,WAAU;0CACtB,cAAA,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;;8DACC,8OAAC;oDAAG,WAAU;8DAAyB,KAAK,KAAK;;;;;;8DACjD,8OAAC;oDAAE,WAAU;;wDAAgB;wDAAK;;;;;;;;;;;;;sDAEpC,8OAAC;4CAAI,WAAU;sDACZ,cAAc,mBACb,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDACC,SAAS,IAAM,eAAe,KAAK,GAAG,CAAC,GAAG,SAAS,eAAe,GAAG,QAAQ;wDAC7E,WAAU;kEACX;;;;;;kEAGD,8OAAC;wDACC,MAAK;wDACL,OAAO;wDACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;wDAC9C,WAAU;wDACV,KAAI;;;;;;kEAEN,8OAAC;wDACC,SAAS,IAAM,eAAe,CAAC,SAAS,eAAe,CAAC,EAAE,QAAQ;wDAClE,WAAU;kEACX;;;;;;kEAGD,8OAAC;wDACC,SAAS,IAAM,YAAY,IAAI;wDAC/B,WAAU;kEACX;;;;;;kEAGD,8OAAC;wDACC,SAAS,IAAM,aAAa;wDAC5B,WAAU;kEACX;;;;;;;;;;;qEAKH,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDACC,SAAS,IAAM,YAAY,IAAI,KAAK,QAAQ,GAAG;wDAC/C,WAAU;wDACV,UAAU,KAAK,QAAQ,IAAI;kEAC5B;;;;;;kEAGD,8OAAC;wDAAK,WAAU;;4DAAoB;4DAAW,KAAK,QAAQ;;;;;;;kEAC5D,8OAAC;wDACC,SAAS,IAAM,YAAY,IAAI,KAAK,QAAQ,GAAG;wDAC/C,WAAU;kEACX;;;;;;kEAGD,8OAAC;wDACC,SAAS;4DACP,aAAa;4DACb,eAAe,KAAK,QAAQ,CAAC,QAAQ;wDACvC;wDACA,WAAU;kEACX;;;;;;;;;;;;;;;;;;;;;;;+BA/DD;;;;;wBAwEd;;;;;;;;;;;;0BAMN,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA8B;;;;;;kCAC5C,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAG,WAAU;kDAAsC;;;;;;kDACpD,8OAAC;wCAAE,WAAU;kDAAoC,gBAAgB,WAAW;;;;;;;;;;;;0CAE9E,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAG,WAAU;kDAAsC;;;;;;kDACpD,8OAAC;wCAAE,WAAU;kDAAqC,gBAAgB,iBAAiB;;;;;;;;;;;;0CAErF,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAG,WAAU;kDAAsC;;;;;;kDACpD,8OAAC;wCAAE,WAAU;kDAAsC,gBAAgB,gBAAgB;;;;;;;;;;;;0CAErF,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAG,WAAU;kDAAsC;;;;;;kDACpD,8OAAC;wCAAE,WAAU;;4CAAqC;4CAAE,gBAAgB,YAAY,CAAC,OAAO,CAAC;;;;;;;;;;;;;;;;;;;kCAI7F,8OAAC;wBAAG,WAAU;kCAA6B;;;;;;kCAC3C,8OAAC;wBAAI,WAAU;kCACZ,OAAO,MAAM,KAAK,kBACjB,8OAAC;4BAAE,WAAU;sCAAiC;;;;;mCAE9C,OAAO,KAAK,CAAC,GAAG,IAAI,GAAG,CAAC,CAAC,sBACvB,8OAAC;gCAAmB,WAAU;;kDAC5B,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;;kEACC,8OAAC;wDAAG,WAAU;;4DAAwB;4DAAQ,MAAM,EAAE;;;;;;;kEACtD,8OAAC;wDAAE,WAAU;;4DAAgB;4DAAU,MAAM,QAAQ,EAAE;4DAAK;4DAAG,MAAM,QAAQ,EAAE;4DAAM;;;;;;;kEACrF,8OAAC;wDAAE,WAAU;;4DAAwB;4DAAQ,IAAI,KAAK,MAAM,SAAS,EAAE,cAAc;;;;;;;;;;;;;0DAEvF,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDAAE,WAAU;;4DAAoB;4DAAS,MAAM,KAAK,EAAE,QAAQ;;;;;;;kEAC/D,8OAAC;wDAAE,WAAU;;4DAAwB;4DAAS,MAAM,MAAM;;;;;;;;;;;;;;;;;;;kDAG9D,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAG,WAAU;0DAAqB;;;;;;0DACnC,8OAAC;gDAAG,WAAU;;kEACZ,8OAAC;;4DAAG;4DAAe,MAAM,QAAQ;4DAAC;;;;;;;kEAClC,8OAAC;;4DAAG;4DAAgB,MAAM,OAAO;4DAAC;;;;;;;;;;;;;;;;;;;kDAGtC,8OAAC;;0DACC,8OAAC;gDAAG,WAAU;0DAAqB;;;;;;0DACnC,8OAAC;gDAAE,WAAU;;oDACV,MAAM,QAAQ,EAAE;oDAAQ;oDAAG,MAAM,QAAQ,EAAE;oDAAK;oDAAG,MAAM,QAAQ,EAAE;oDAAW;oDAAG,MAAM,QAAQ,EAAE;;;;;;;;;;;;;;+BAtB9F,MAAM,EAAE;;;;;;;;;;;;;;;;;;;;;;AAgChC"}}]
}